<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taoshu.db.auth.dao.SysUserMapper">
	<resultMap id="BaseResultMap" type="com.taoshu.db.auth.module.SysUser">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="user_id" jdbcType="BIGINT" property="userId" />
		<result column="customer_id" jdbcType="BIGINT" property="customerId" />
		<result column="user_name" jdbcType="VARCHAR" property="userName" />
		<result column="user_nick_name" jdbcType="VARCHAR" property="userNickName" />
		<result column="user_pwd" jdbcType="VARCHAR" property="userPwd" />
		<result column="user_type" jdbcType="VARCHAR" property="userType" />
		<result column="user_status" jdbcType="VARCHAR" property="userStatus" />
		<result column="lock_status" jdbcType="VARCHAR" property="lockStatus" />
		<result column="create_date" jdbcType="DATE" property="createDate" />
		<result column="modify_date" jdbcType="DATE" property="modifyDate" />
		<result column="pass_modify_date" jdbcType="DATE" property="passModifyDate" />
		<result column="mobile" jdbcType="VARCHAR" property="mobile" />
		<result column="email" jdbcType="VARCHAR" property="email" />
		<result column="ext_flag" jdbcType="VARCHAR" property="extFlag" />
		<result column="remark" jdbcType="VARCHAR" property="remark" />
		<result column="user_token" jdbcType="VARCHAR" property="userToken" />
		<result column="validate_time" jdbcType="BIGINT" property="validateTime" />
		<result column="user_order" jdbcType="INTEGER" property="userOrder" />
		<result column="identitytype" jdbcType="VARCHAR" property="identitytype" />
		<result column="identityno" jdbcType="VARCHAR" property="identityno" />
		<result column="credentials" jdbcType="VARCHAR" property="credentials" />
		<result column="create_time" jdbcType="INTEGER" property="createTime" />
		<result column="modify_time" jdbcType="INTEGER" property="modifyTime" />
		<result column="org_id" jdbcType="VARCHAR" property="orgId" />
	</resultMap>

	<resultMap id="MenuResultMap" type="com.taoshu.db.auth.module.SysMenu">
		<id column="menu_code" jdbcType="VARCHAR" property="menuCode" />
		<result column="menu_name" jdbcType="VARCHAR" property="menuName" />
		<result column="menu_arg" jdbcType="VARCHAR" property="menuArg" />
		<result column="menu_icon" jdbcType="VARCHAR" property="menuIcon" />
		<result column="menu_url" jdbcType="VARCHAR" property="menuUrl" />
		<result column="parent_code" jdbcType="VARCHAR" property="parentCode" />
		<result column="order_no" jdbcType="VARCHAR" property="orderNo" />
		<result column="tree_idx" jdbcType="VARCHAR" property="treeIdx" />
		<result column="remark" jdbcType="VARCHAR" property="remark" />
	</resultMap>

	<sql id="Menu_Column_List">
		m.menu_code as menu_code, menu_name, menu_arg, menu_icon, menu_url, parent_code,
		order_no, tree_idx,remark
	</sql>

	<sql id="Role_Column_List">
		r.role_code as role_code, role_name, creator, remark, role_order, create_date,
		create_time, modify_date,
		modify_time
	</sql>

	<select id="selectRoles" resultType="com.taoshu.db.auth.module.SysRole"
		parameterType="java.lang.Long">
		select
		<include refid="Role_Column_List" />
		from sys_role_user ru,sys_role r where ru.user_id=#{user_id} and
		r.role_code=ru.role_code
	</select>

	<resultMap id="UserRoleResultMap" type="com.taoshu.db.auth.dto.UserRoleInfo"
		extends="BaseResultMap">
		<id property="userId" column="user_id" jdbcType="BIGINT" />

		<collection property="roleList" column="user_id" javaType="java.util.List"
			ofType="com.taoshu.db.auth.dto.SysRole" select="selectRoles" />
	</resultMap>

	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		user_id, customer_id,user_name, user_nick_name, user_pwd, user_type,
		user_status, lock_status,
		create_date, modify_date, pass_modify_date, mobile, email, ext_flag, remark,
		user_order, user_token,validate_time
		identitytype, identityno, credentials, create_time, modify_time, org_id
	</sql>

	<select id="selectMenus" resultType="com.taoshu.db.auth.module.SysMenu"
		parameterType="java.util.Map">
		select
		<include refid="Menu_Column_List" />
		from sys_menu_role mr,sys_menu m where
		mr.role_code=#{roleCode,jdbcType=BIGINT} and mr.menu_code=m.menu_code
	</select>

	<select id="selectByPrimaryKey" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from sys_user
		where user_id = #{userId,jdbcType=BIGINT}
	</select>

	<select id="selectUserRoleInfo" parameterType="com.taoshu.db.auth.module.SysUser"
		resultMap="UserRoleResultMap">
		select
		<include refid="Base_Column_List" />
		from
		sys_user
		where 1=1

		<if test="userId != null and userId !=''">
			and user_id = #{userId,jdbcType=BIGINT}
		</if>
		<if test="userName != null and userName !=''">
			and user_name = #{userName,jdbcType=VARCHAR}
		</if>
	</select>

	<select id="selectByUserName" parameterType="java.lang.String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from sys_user
		where user_name = #{userName,jdbcType=VARCHAR}
	</select>

	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from sys_user
		where user_id = #{userId,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="com.taoshu.db.auth.module.SysUser"
		useGeneratedKeys="true" keyProperty="userId">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into sys_user (customer_id,user_name, user_nick_name,
		user_pwd, user_type, user_status,
		lock_status, create_date, modify_date,
		pass_modify_date, mobile, email,
		ext_flag, remark, user_order,
		identitytype, identityno, credentials,
		create_time, modify_time, org_id
		)
		values ( #{customerId,jdbcType=BIGINT},#{userName,jdbcType=VARCHAR},
		#{userNickName,jdbcType=VARCHAR},
		#{userPwd,jdbcType=VARCHAR}, #{userType,jdbcType=VARCHAR}, #{userStatus,jdbcType=VARCHAR},
		#{lockStatus,jdbcType=VARCHAR}, #{createDate,jdbcType=BIGINT},
		#{modifyDate,jdbcType=BIGINT},
		#{passModifyDate,jdbcType=BIGINT}, #{mobile,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR},
		#{extFlag,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR},
		#{userOrder,jdbcType=INTEGER},
		#{identitytype,jdbcType=VARCHAR}, #{identityno,jdbcType=VARCHAR}, #{credentials,jdbcType=VARCHAR},
		#{createTime,jdbcType=INTEGER}, #{modifyTime,jdbcType=INTEGER},
		#{orgId,jdbcType=VARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.taoshu.db.auth.module.SysUser">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into sys_user
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="userId != null">
				user_id,
			</if>
			<if test="customerId != null">
				customer_id,
			</if>
			<if test="userName != null">
				user_name,
			</if>
			<if test="userNickName != null">
				user_nick_name,
			</if>
			<if test="userPwd != null">
				user_pwd,
			</if>
			<if test="userType != null">
				user_type,
			</if>
			<if test="userStatus != null">
				user_status,
			</if>
			<if test="lockStatus != null">
				lock_status,
			</if>
			<if test="createDate != null">
				create_date,
			</if>
			<if test="modifyDate != null">
				modify_date,
			</if>
			<if test="passModifyDate != null">
				pass_modify_date,
			</if>
			<if test="mobile != null">
				mobile,
			</if>
			<if test="email != null">
				email,
			</if>
			<if test="extFlag != null">
				ext_flag,
			</if>
			<if test="remark != null">
				remark,
			</if>
			<if test="userOrder != null">
				user_order,
			</if>
			<if test="identitytype != null">
				identitytype,
			</if>
			<if test="identityno != null">
				identityno,
			</if>
			<if test="credentials != null">
				credentials,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="modifyTime != null">
				modify_time,
			</if>
			<if test="orgId != null">
				org_id,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="userId != null">
				#{userId,jdbcType=VARCHAR},
			</if>
			<if test="customerId != null">
				#{customerId,jdbcType=BIGINT},
			</if>
			<if test="userName != null">
				#{userName,jdbcType=VARCHAR},
			</if>
			<if test="userNickName != null">
				#{userNickName,jdbcType=VARCHAR},
			</if>
			<if test="userPwd != null">
				#{userPwd,jdbcType=VARCHAR},
			</if>
			<if test="userType != null">
				#{userType,jdbcType=VARCHAR},
			</if>
			<if test="userStatus != null">
				#{userStatus,jdbcType=VARCHAR},
			</if>
			<if test="lockStatus != null">
				#{lockStatus,jdbcType=VARCHAR},
			</if>
			<if test="createDate != null">
				#{createDate,jdbcType=BIGINT},
			</if>
			<if test="modifyDate != null">
				#{modifyDate,jdbcType=BIGINT},
			</if>
			<if test="passModifyDate != null">
				#{passModifyDate,jdbcType=BIGINT},
			</if>
			<if test="mobile != null">
				#{mobile,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				#{email,jdbcType=VARCHAR},
			</if>
			<if test="extFlag != null">
				#{extFlag,jdbcType=VARCHAR},
			</if>
			<if test="remark != null">
				#{remark,jdbcType=VARCHAR},
			</if>
			<if test="userOrder != null">
				#{userOrder,jdbcType=INTEGER},
			</if>
			<if test="identitytype != null">
				#{identitytype,jdbcType=VARCHAR},
			</if>
			<if test="identityno != null">
				#{identityno,jdbcType=VARCHAR},
			</if>
			<if test="credentials != null">
				#{credentials,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=INTEGER},
			</if>
			<if test="modifyTime != null">
				#{modifyTime,jdbcType=INTEGER},
			</if>
			<if test="orgId != null">
				#{orgId,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.taoshu.db.auth.module.SysUser">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update sys_user
		<set>
			<if test="userName != null">
				user_name = #{userName,jdbcType=VARCHAR},
			</if>
			<if test="userNickName != null">
				user_nick_name = #{userNickName,jdbcType=VARCHAR},
			</if>
			<if test="userPwd != null">
				user_pwd = #{userPwd,jdbcType=VARCHAR},
			</if>
			<if test="userType != null">
				user_type = #{userType,jdbcType=VARCHAR},
			</if>
			<if test="userStatus != null">
				user_status = #{userStatus,jdbcType=VARCHAR},
			</if>
			<if test="lockStatus != null">
				lock_status = #{lockStatus,jdbcType=VARCHAR},
			</if>
			<if test="createDate != null">
				create_date = #{createDate,jdbcType=BIGINT},
			</if>
			<if test="modifyDate != null">
				modify_date = #{modifyDate,jdbcType=BIGINT},
			</if>
			<if test="passModifyDate != null">
				pass_modify_date = #{passModifyDate,jdbcType=BIGINT},
			</if>
			<if test="mobile != null">
				mobile = #{mobile,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				email = #{email,jdbcType=VARCHAR},
			</if>
			<if test="extFlag != null">
				ext_flag = #{extFlag,jdbcType=VARCHAR},
			</if>
			<if test="userToken != null">
				user_token = #{userToken,jdbcType=BIGINT},
			</if>
			<if test="validateTime != null">
				validate_time = #{validateTime,jdbcType=VARCHAR},
			</if>
			<if test="remark != null">
				remark = #{remark,jdbcType=VARCHAR},
			</if>
			<if test="userOrder != null">
				user_order = #{userOrder,jdbcType=INTEGER},
			</if>
			<if test="identitytype != null">
				identitytype = #{identitytype,jdbcType=VARCHAR},
			</if>
			<if test="identityno != null">
				identityno = #{identityno,jdbcType=VARCHAR},
			</if>
			<if test="credentials != null">
				credentials = #{credentials,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=INTEGER},
			</if>
			<if test="modifyTime != null">
				modify_time = #{modifyTime,jdbcType=INTEGER},
			</if>
			<if test="orgId != null">
				org_id = #{orgId,jdbcType=VARCHAR},
			</if>
		</set>
		where user_id = #{userId,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.taoshu.db.auth.module.SysUser">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update sys_user
		set user_name = #{userName,jdbcType=VARCHAR},
		user_nick_name = #{userNickName,jdbcType=VARCHAR},
		user_pwd = #{userPwd,jdbcType=VARCHAR},
		user_type = #{userType,jdbcType=VARCHAR},
		user_status = #{userStatus,jdbcType=VARCHAR},
		lock_status = #{lockStatus,jdbcType=VARCHAR},
		create_date = #{createDate,jdbcType=BIGINT},
		modify_date = #{modifyDate,jdbcType=BIGINT},
		pass_modify_date = #{passModifyDate,jdbcType=BIGINT},
		mobile = #{mobile,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		ext_flag = #{extFlag,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		user_order = #{userOrder,jdbcType=INTEGER},
		identitytype = #{identitytype,jdbcType=VARCHAR},
		identityno = #{identityno,jdbcType=VARCHAR},
		credentials = #{credentials,jdbcType=VARCHAR},
		create_time = #{createTime,jdbcType=INTEGER},
		modify_time = #{modifyTime,jdbcType=INTEGER},
		org_id = #{orgId,jdbcType=VARCHAR}
		where user_id = #{userId,jdbcType=VARCHAR}
	</update>


	<select id="selectUserPageByParam" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from sys_user
		where 1=1
		<if test="userName != null and userName !=''">
			and user_name like concat(concat('%',#{userName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="userNickName != null and userNickName !=''">
			and user_nick_name like
			concat(concat('%',#{userNickName,jdbcType=VARCHAR}),'%')
		</if>
		<if test="mobile != null and mobile !=''">
			and mobile like concat(concat('%',#{mobile,jdbcType=VARCHAR}),'%')
		</if>

		<if test="userType != null and userType !=''">
			and user_type in
			<foreach collection="userType" item="item" index="index" open="("
				close=")" separator=",">
				#{item}
			</foreach>
		</if>

	</select>
	<select id="selectByContact" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from sys_user
		where email = #{email,jdbcType=VARCHAR}
		<!-- or mobile = #{mobile,jdbcType=VARCHAR} --> 
	</select>
</mapper>